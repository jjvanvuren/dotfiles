# ╔═══════════════════════════════════════════════════════════════════════════╗
# ║                        HYPRLAND CONFIGURATION                             ║
# ║                                                                           ║
# ║  Wiki: https://wiki.hypr.land/Configuring/                                ║
# ╚═══════════════════════════════════════════════════════════════════════════╝

# Theme (Catppuccin Macchiato color scheme)
source = ~/.config/hypr/macchiato.conf
env = GTK_THEME,catppuccin-macchiato-blue-standard+default


# ┌───────────────────────────────────────────────────────────────────────────┐
# │                              MONITORS                                     │
# └───────────────────────────────────────────────────────────────────────────┘
# Syntax: monitor = name, resolution, position, scale
# See: https://wiki.hypr.land/Configuring/Monitors/

monitor = , preferred, auto, auto       # Fallback for any monitor
monitor = DP-3, preferred, auto, 1      # DisplayPort 3 at scale 1
monitor = DP-4, 5120x1440@165, auto, 1      # DisplayPort 4 at scale 1


# ┌───────────────────────────────────────────────────────────────────────────┐
# │                           DEFAULT PROGRAMS                                │
# └───────────────────────────────────────────────────────────────────────────┘

$terminal    = kitty
$browser     = zen-browser
$fileManager = thunar
$menu        = wofi --conf ~/.config/wofi/config --style ~/.config/wofi/style.css


# ┌───────────────────────────────────────────────────────────────────────────┐
# │                              AUTOSTART                                    │
# └───────────────────────────────────────────────────────────────────────────┘
# Processes launched once at Hyprland startup

exec-once = waybar & dunst              # Status bar and notifications
exec-once = hyprpaper                   # Wallpaper daemon
exec-once = udiskie --tray              # Automount removable media
exec-once = /usr/lib/polkit-gnome/polkit-gnome-authentication-agent-1 &  # Polkit auth agent

# Clipboard management (cliphist)
exec-once = wl-paste --primary --watch wl-copy
exec-once = wl-paste --type text --watch cliphist store
exec-once = wl-paste --type image --watch cliphist store


# ┌───────────────────────────────────────────────────────────────────────────┐
# │                        ENVIRONMENT VARIABLES                              │
# └───────────────────────────────────────────────────────────────────────────┘

env = XCURSOR_SIZE, 24
env = HYPRCURSOR_SIZE, 24


# ┌───────────────────────────────────────────────────────────────────────────┐
# │                            LOOK AND FEEL                                  │
# └───────────────────────────────────────────────────────────────────────────┘

# General window behavior
# See: https://wiki.hypr.land/Configuring/Variables/#general
general {
    gaps_in  = 5
    gaps_out = 10
    border_size = 2

    col.active_border   = rgba(33ccffee) rgba(00ff99ee) 45deg
    col.inactive_border = rgba(595959aa)

    resize_on_border = false
    allow_tearing    = false
    layout           = dwindle
}

# Window decoration (rounding, shadows, blur)
# See: https://wiki.hypr.land/Configuring/Variables/#decoration
decoration {
    rounding       = 5
    rounding_power = 2

    active_opacity   = 1.0
    inactive_opacity = 1.0

    shadow {
        enabled      = true
        range        = 4
        render_power = 3
        color        = rgba(1a1a1aee)
    }

    blur {
        enabled   = true
        size      = 3
        passes    = 1
        vibrancy  = 0.1696
    }
}

# Animations
# See: https://wiki.hypr.land/Configuring/Animations/
animations {
    enabled = yes, please :)

    # Bezier curves: NAME, X0, Y0, X1, Y1
    bezier = easeOutQuint,   0.23, 1,    0.32, 1
    bezier = easeInOutCubic, 0.65, 0.05, 0.36, 1
    bezier = linear,         0,    0,    1,    1
    bezier = almostLinear,   0.5,  0.5,  0.75, 1
    bezier = quick,          0.15, 0,    0.1,  1

    # Animation definitions: NAME, ONOFF, SPEED, CURVE, [STYLE]
    animation = global,        1, 10,   default
    animation = border,        1, 5.39, easeOutQuint
    animation = windows,       1, 4.79, easeOutQuint
    animation = windowsIn,     1, 4.1,  easeOutQuint,  popin 87%
    animation = windowsOut,    1, 1.49, linear,        popin 87%
    animation = fadeIn,        1, 1.73, almostLinear
    animation = fadeOut,       1, 1.46, almostLinear
    animation = fade,          1, 3.03, quick
    animation = layers,        1, 3.81, easeOutQuint
    animation = layersIn,      1, 4,    easeOutQuint,  fade
    animation = layersOut,     1, 1.5,  linear,        fade
    animation = fadeLayersIn,  1, 1.79, almostLinear
    animation = fadeLayersOut, 1, 1.39, almostLinear
    animation = workspaces,    1, 1.94, almostLinear,  fade
    animation = workspacesIn,  1, 1.21, almostLinear,  fade
    animation = workspacesOut, 1, 1.94, almostLinear,  fade
    animation = zoomFactor,    1, 7,    quick
}

# Dwindle layout (default)
# See: https://wiki.hypr.land/Configuring/Dwindle-Layout/
dwindle {
    pseudotile     = true    # SUPER+P to toggle pseudotiling
    preserve_split = true    # Keep split direction when moving windows
    force_split    = 1       # Always split below (vertical stacking)
}

# Master layout (alternative)
# See: https://wiki.hypr.land/Configuring/Master-Layout/
master {
    new_status = master
}

# Miscellaneous
misc {
    force_default_wallpaper = -1    # -1 = random anime wallpaper, 0/1 = disable
    disable_hyprland_logo   = false
}


# ┌───────────────────────────────────────────────────────────────────────────┐
# │                               INPUT                                       │
# └───────────────────────────────────────────────────────────────────────────┘
# See: https://wiki.hypr.land/Configuring/Variables/#input

input {
    kb_layout  = us
    kb_variant =
    kb_model   =
    kb_options =
    kb_rules   =

    follow_mouse   = 1
    sensitivity    = 0    # Range: -1.0 to 1.0 (0 = no modification)
    natural_scroll = false

    touchpad {
        natural_scroll = false
    }
}

# Touchpad gestures
gesture = 3, horizontal, workspace

# Per-device configuration
device {
    name        = epic-mouse-v1
    sensitivity = -0.5
}


# ┌───────────────────────────────────────────────────────────────────────────┐
# │                            KEYBINDINGS                                    │
# └───────────────────────────────────────────────────────────────────────────┘
# See: https://wiki.hypr.land/Configuring/Binds/
# Modifier key (SUPER = Windows/Meta key)
$mainMod = SUPER

# ─── Core Application Launchers ───────────────────────────────────────────────
bind = $mainMod,       Return,       exec, $terminal
bind = $mainMod SHIFT, Return,       exec, $browser
bind = $mainMod,       SPACE,        exec, $menu
bind = $mainMod,       E,            exec, $fileManager

# ─── Session Control ──────────────────────────────────────────────────────────
bind = $mainMod,       escape,       exec, hyprlock
bind = $mainMod SHIFT, escape,       exec, shutdown now
bind = $mainMod SHIFT, Z,            exec, hyprlock & sleep 0.5 && systemctl suspend
bind = $mainMod SHIFT, C,            exec, hyprctl reload

# ─── Window Management ────────────────────────────────────────────────────────
bind = $mainMod,       Q,            killactive,
bind = $mainMod,       V,            togglefloating,
bind = $mainMod,       P,            pseudo,           # Pseudotile (dwindle)
bind = $mainMod,       T,            togglesplit,      # Toggle split direction (dwindle)
bind = $mainMod,       F,            fullscreen, 0     # True fullscreen (hides bar)
bind = $mainMod SHIFT, F,            fullscreen, 1     # Maximize (keeps bar & gaps)
bind = $mainMod,       A,            cyclenext, floating  # Focus floating/tiling toggle

# ─── Clipboard ────────────────────────────────────────────────────────────────
bind = $mainMod SHIFT, V,            exec, cliphist list | wofi --dmenu | cliphist decode | wl-copy

# ─── Screenshots (hyprshot) ───────────────────────────────────────────────────
bind = ,               Print,        exec, hyprshot -m region    # Select region
bind = SHIFT,          Print,        exec, hyprshot -m output    # Current monitor
bind = CTRL,           Print,        exec, hyprshot -m window    # Active window

# ─── Notifications (dunst) ────────────────────────────────────────────────────
bind = $mainMod,       N,            exec, dunstctl history-pop
bind = $mainMod SHIFT, N,            exec, dunstctl close-all && dunstctl history-clear

# ─── Bar Toggle ───────────────────────────────────────────────────────────────
bind = $mainMod SHIFT, B,            exec, killall -SIGUSR1 waybar

# ─── Focus Movement (vim-style + arrows) ──────────────────────────────────────
bind = $mainMod,       H,            movefocus, l
bind = $mainMod,       J,            movefocus, d
bind = $mainMod,       K,            movefocus, u
bind = $mainMod,       L,            movefocus, r
bind = $mainMod,       left,         movefocus, l
bind = $mainMod,       down,         movefocus, d
bind = $mainMod,       up,           movefocus, u
bind = $mainMod,       right,        movefocus, r

# ─── Window Movement ──────────────────────────────────────────────────────────
bind = $mainMod SHIFT, H,            movewindow, l
bind = $mainMod SHIFT, J,            movewindow, d
bind = $mainMod SHIFT, K,            movewindow, u
bind = $mainMod SHIFT, L,            movewindow, r
bind = $mainMod SHIFT, left,         movewindow, l
bind = $mainMod SHIFT, down,         movewindow, d
bind = $mainMod SHIFT, up,           movewindow, u
bind = $mainMod SHIFT, right,        movewindow, r

# ─── Workspace Switching ──────────────────────────────────────────────────────
bind = $mainMod,       1,            workspace, 1
bind = $mainMod,       2,            workspace, 2
bind = $mainMod,       3,            workspace, 3
bind = $mainMod,       4,            workspace, 4
bind = $mainMod,       5,            workspace, 5
bind = $mainMod,       6,            workspace, 6
bind = $mainMod,       7,            workspace, 7
bind = $mainMod,       8,            workspace, 8
bind = $mainMod,       9,            workspace, 9
bind = $mainMod,       0,            workspace, 10

# ─── Move Window to Workspace ─────────────────────────────────────────────────
bind = $mainMod SHIFT, 1,            movetoworkspace, 1
bind = $mainMod SHIFT, 2,            movetoworkspace, 2
bind = $mainMod SHIFT, 3,            movetoworkspace, 3
bind = $mainMod SHIFT, 4,            movetoworkspace, 4
bind = $mainMod SHIFT, 5,            movetoworkspace, 5
bind = $mainMod SHIFT, 6,            movetoworkspace, 6
bind = $mainMod SHIFT, 7,            movetoworkspace, 7
bind = $mainMod SHIFT, 8,            movetoworkspace, 8
bind = $mainMod SHIFT, 9,            movetoworkspace, 9
bind = $mainMod SHIFT, 0,            movetoworkspace, 10

# ─── Special Workspace (Scratchpad) ───────────────────────────────────────────
bind = $mainMod,       S,            togglespecialworkspace, magic
bind = $mainMod SHIFT, S,            movetoworkspace, special:magic

# ─── Mouse Bindings ───────────────────────────────────────────────────────────
bind  = $mainMod,      mouse_down,   workspace, e+1
bind  = $mainMod,      mouse_up,     workspace, e-1
bindm = $mainMod,      mouse:272,    movewindow       # LMB drag to move
bindm = $mainMod,      mouse:273,    resizewindow     # RMB drag to resize

# ─── Media Keys ───────────────────────────────────────────────────────────────
bindel = , XF86AudioRaiseVolume,     exec, wpctl set-volume -l 1 @DEFAULT_AUDIO_SINK@ 5%+
bindel = , XF86AudioLowerVolume,     exec, wpctl set-volume @DEFAULT_AUDIO_SINK@ 5%-
bindel = , XF86AudioMute,            exec, wpctl set-mute @DEFAULT_AUDIO_SINK@ toggle
bindel = , XF86AudioMicMute,         exec, wpctl set-mute @DEFAULT_AUDIO_SOURCE@ toggle
bindel = , XF86MonBrightnessUp,      exec, brightnessctl -e4 -n2 set 5%+
bindel = , XF86MonBrightnessDown,    exec, brightnessctl -e4 -n2 set 5%-

# Media playback (requires playerctl)
bindl  = , XF86AudioNext,            exec, playerctl next
bindl  = , XF86AudioPause,           exec, playerctl play-pause
bindl  = , XF86AudioPlay,            exec, playerctl play-pause
bindl  = , XF86AudioPrev,            exec, playerctl previous

# ─── Window Groups (Tabbed Containers) ────────────────────────────────────────
bind = $mainMod,       G,            togglegroup
bind = $mainMod,       TAB,          changegroupactive, f     # Next tab
bind = $mainMod,       BACKSPACE,    changegroupactive, b     # Previous tab
bind = $mainMod SHIFT, G,            moveintogroup
bind = $mainMod SHIFT, E,            moveoutofgroup

# Group styling (uses Catppuccin theme colors)
group {
    col.border_active   = $mauve
    col.border_inactive = $surface2

    groupbar {
        enabled              = true
        height               = 18
        font_size            = 12
        font_weight_active   = bold
        font_weight_inactive = normal
        render_titles        = true
        scrolling            = true
        gradients            = false
        col.active           = $mauve
        col.inactive         = $surface1
        text_color           = $text
    }
}

# ─── Resize Mode ──────────────────────────────────────────────────────────────
# Enter resize mode with SUPER+R, exit with Escape or SUPER+R
bind = $mainMod, R, submap, resize

submap = resize
    # Vim-style resize (10px steps)
    binde = ,     h, resizeactive, -10 0
    binde = ,     l, resizeactive,  10 0
    binde = ,     j, resizeactive,  0  10
    binde = ,     k, resizeactive,  0 -10

    # Large resize (50px steps with Shift)
    binde = SHIFT, h, resizeactive, -50 0
    binde = SHIFT, l, resizeactive,  50 0
    binde = SHIFT, j, resizeactive,  0  50
    binde = SHIFT, k, resizeactive,  0 -50

    bind = ,        escape, submap, reset
    bind = $mainMod, R,     submap, reset
submap = reset


# ┌───────────────────────────────────────────────────────────────────────────┐
# │                           WINDOW RULES                                    │
# └───────────────────────────────────────────────────────────────────────────┘
# See: https://wiki.hypr.land/Configuring/Window-Rules/

# Suppress maximize requests from all applications
windowrule {
    name        = suppress-maximize-events
    match:class = .*
    suppress_event = maximize
}

# Fix XWayland drag issues
windowrule {
    name             = fix-xwayland-drags
    match:class      = ^$
    match:title      = ^$
    match:xwayland   = true
    match:float      = true
    match:fullscreen = false
    match:pin        = false
    no_focus         = true
}

# Hyprland-run launcher positioning
windowrule {
    name        = move-hyprland-run
    match:class = hyprland-run
    move        = 20 monitor_h-120
    float       = yes
}
